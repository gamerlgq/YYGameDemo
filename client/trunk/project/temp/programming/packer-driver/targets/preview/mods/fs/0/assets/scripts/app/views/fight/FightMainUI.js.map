{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/YYGameDemo/client/trunk/project/assets/scripts/app/views/fight/FightMainUI.ts"],"names":["_decorator","AnimationComponent","Button","Label","CCFloat","js","Sprite","sceneMgr","socketMgr","ComponentBase","Protocol","FightEvent","fightEventMgr","FightConstant","ccclass","property","FightMainUI","onLoad","_root","node","parent","_addFightListeners","_setSpeed","addEventListener","Round_Start","_updateRoundLabel","bind","event","data","getEventData","round","Round","toString","lblRound","setString","speed","_curSpeedIdx","speedList","lblSpeed","enabled","spSpeed","formatStr","startGame","onClickStartBtn","customEventData","startBtn","active","animteComp","getComponent","play","send","Game_Star","onClickCloseBtn","popTableLayer","update","dt","onClickSpeedBtn","length","sendInnerMsg","Inner","SetAnimationSpeed"],"mappings":"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","sourcesContent":["/*\n * @Author: liuguoqing\n * @Date: 2022-03-19 11:17:19\n * @LastEditors: liuguoqing\n * @LastEditTime: 2022-03-20 17:15:25\n * @Description: file content\n */\n\nimport { _decorator, Node, EventTouch, AnimationComponent, Button, Label, CCFloat, js, Sprite, log, } from 'cc';\nimport { sceneMgr } from '../../../framework/core/SceneMgr';\nimport { socketMgr } from '../../../framework/net/SocketMgr';\nimport { ComponentBase } from '../../../framework/ui/ComponentBase';\nimport { Protocol } from '../../define/Protocol';\nimport { FightEvent } from './event/FightEvent';\nimport { FightEventDataType } from './event/FightEventDataType';\nimport { fightEventMgr } from './event/FightEventMgr';\nimport { FightConstant } from './FightConstant';\nconst { ccclass, property } = _decorator;\n \n@ccclass('FightMainUI')\nexport class FightMainUI extends ComponentBase {\n\n    @property(Button)\n    startBtn:Button=null;\n\n    @property(Label)\n    lblRound:Label=null;\n\n    @property(Label)\n    lblSpeed:Label=null;\n\n    @property(Sprite)\n    spSpeed:Sprite=null;\n\n    @property([CCFloat])\n    speedList:number[] = [];\n\n    private _root:Node = null;\n    private _curSpeedIdx:number = 0;\n\n    onLoad(){\n        this._root = this.node.parent;\n        this._addFightListeners();\n        this._setSpeed();\n    }\n\n    private _addFightListeners(){\n        fightEventMgr.addEventListener(FightConstant.FightEvent.Round_Start,this._updateRoundLabel.bind(this));\n    }\n\n    // 设置回合数\n    private _updateRoundLabel(event:FightEvent) {\n        let data:FightEventDataType.Round_Start = event.getEventData();\n        let round = data.Round.toString();\n        this.lblRound.setString(round);\n    }\n\n    private _setSpeed():number{\n        let speed:number = 1;\n        if ( this._curSpeedIdx != 0 ){\n            speed = this.speedList[this._curSpeedIdx];\n        }\n\n        if ( speed == 1 ){\n            this.lblSpeed.enabled = false;\n            this.spSpeed.enabled = true;\n            return speed;\n        }\n\n        this.lblSpeed.enabled = true;\n        this.spSpeed.enabled = false;\n        if ( speed == 0.5 ){\n            this.lblSpeed.setString(\"1/2倍\");\n            return speed;\n        }\n        \n        this.lblSpeed.setString(js.formatStr(\"%d倍\",speed));\n        return speed;\n    }\n\n    // 战斗开始\n    startGame(){\n        \n    }\n\n    onClickStartBtn(event:EventTouch,customEventData:string){\n        this.startBtn.node.active = false;\n        let animteComp = this._root.getComponent(AnimationComponent);\n        animteComp.play();\n        fightEventMgr.send(new FightEvent(FightConstant.FightEvent.Game_Star,null));\n    }\n\n    onClickCloseBtn(event:EventTouch,customEventData:string){\n        sceneMgr.popTableLayer();\n    }\n\n    update(dt:number){\n\n    }\n\n    onClickSpeedBtn(event:EventTouch,customEventData:string){\n        this._curSpeedIdx += 1 ;\n        if (this._curSpeedIdx >= this.speedList.length) {\n            this._curSpeedIdx = 0;\n        }\n        let speed = this._setSpeed();\n        socketMgr.sendInnerMsg(Protocol.Inner.SetAnimationSpeed,speed);\n    }\n}"]}