{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/YYGameDemo/client/trunk/project/assets/scripts/app/views/maincity/Creator.ts"],"names":["MainCityCreator","instantiate","sceneMgr","ResourcesLoader","ViewCreatorBase","ViewProtocol","viewRegisterMgr","onInit","regMsg","MainCityLayer","_onCreateMainCityLayer","bind","viewInfo","getViewInfo","loadWithViewInfo","data","uiNode","_loadBg","bg","bgNode","replaceMainLayer","System","addChild","callback"],"mappings":";;;sHAQaA,e;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AARJC,MAAAA,W,OAAAA,W;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,e,iBAAAA,e;;;;;;;iCAGIN,e,GAAN,MAAMA,eAAN;AAAA;AAAA,8CAA8C;AAEjDO,QAAAA,MAAM,GAAG;AACL,eAAKC,MAAL,CAAY;AAAA;AAAA,4CAAaC,aAAzB,EAAwC,KAAKC,sBAAL,CAA4BC,IAA5B,CAAiC,IAAjC,CAAxC;AACH;;AAEOD,QAAAA,sBAAsB,GAAG;AAC7B,cAAIE,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,WAAhB,CAA4B,UAA5B,EAAuC,YAAvC,CAAf;AACA;AAAA;AAAA,kDAAgBC,gBAAhB,CAAiCF,QAAjC,EAA2CG,IAAD,IAAe;AACrD,gBAAIC,MAAM,GAAGf,WAAW,CAACc,IAAD,CAAxB;;AACA,iBAAKE,OAAL,CAAcC,EAAD,IAAa;AACtB,kBAAIC,MAAM,GAAGlB,WAAW,CAACiB,EAAD,CAAxB;AACA;AAAA;AAAA,wCAASE,gBAAT,CAA0BD,MAA1B,EAAiCP,QAAQ,CAACS,MAA1C;AACAF,cAAAA,MAAM,CAACG,QAAP,CAAgBN,MAAhB;AACH,aAJD;AAKH,WAPD;AAQH;;AAEOC,QAAAA,OAAO,CAACM,QAAD,EAA6B;AACxC;AACA,cAAIX,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,WAAhB,CAA4B,UAA5B,EAAuC,eAAvC,CAAf;AACA;AAAA;AAAA,kDAAgBC,gBAAhB,CAAiCF,QAAjC,EAA2CG,IAAD,IAAe;AACrD,gBAAIQ,QAAJ,EAAa;AACTA,cAAAA,QAAQ,CAACR,IAAD,CAAR;AACH;AACJ,WAJD;AAKH;;AA1BgD,O","sourcesContent":["import { instantiate, log, Prefab } from \"cc\";\nimport { sceneMgr } from \"../../../framework/core/SceneMgr\";\nimport { ResourcesLoader } from \"../../../framework/data/ResourcesLoader\";\nimport { ViewCreatorBase } from \"../../../framework/ui/ViewCreatorBase\";\nimport { ViewProtocol } from \"../../define/define\";\nimport { viewRegisterMgr } from \"../../define/ViewRegisterMgr\";\n\n\nexport class MainCityCreator extends ViewCreatorBase {\n\n    onInit() {\n        this.regMsg(ViewProtocol.MainCityLayer, this._onCreateMainCityLayer.bind(this))\n    }\n\n    private _onCreateMainCityLayer() {\n        let viewInfo = viewRegisterMgr.getViewInfo(\"maincity\",\"MainCityUI\");\n        ResourcesLoader.loadWithViewInfo(viewInfo,(data:Prefab)=>{\n            let uiNode = instantiate(data);\n            this._loadBg((bg:Prefab)=>{\n                let bgNode = instantiate(bg);\n                sceneMgr.replaceMainLayer(bgNode,viewInfo.System);\n                bgNode.addChild(uiNode);\n            })\n        })\n    }\n\n    private _loadBg(callback:(bg:Prefab)=>void) {\n        //创建主城界面\n        let viewInfo = viewRegisterMgr.getViewInfo(\"maincity\",\"MainCityLayer\");\n        ResourcesLoader.loadWithViewInfo(viewInfo,(data:Prefab)=>{\n            if (callback){\n                callback(data);\n            }\n        })\n    }\n\n}"]}