{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/GameDemoReal/assets/scripts/app/views/common/spine/SpineNodeBase.ts"],"names":["HeroSpineNode","MonsterSpineNode","_decorator","Node","instantiate","Vec3","UIOpacity","ResourcesLoader","FightConstant","SpineComponentBase","ccclass","SpineNodeBase","formationIndex","v","_formationIndex","camp","_camp","spineCom","_spineCom","constructor","spineNode","addChild","getComponentInChildren","addComponent","play","actionName","isLoop","addEffectFront","node","offset","addEffectBack","addBloodUI","path","load","prefab","FightUnitType","Defend","setScale","updateBlood","cur","top","changeSkin","skinName","changeEquip","oldSlotName","newSlotName","setAnimateStartCallback","callback","setAnimateEndCallback","setAnimateInterruptCallback","setAnimateEventCallback"],"mappings":"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","sourcesContent":["/*\n * @Author: liuguoqing\n * @Date: 2022-03-19 11:17:19\n * @LastEditors: liuguoqing\n * @LastEditTime: 2022-03-20 16:41:48\n * @Description: file content\n */\n\nimport { _decorator,Node, sp, Prefab, instantiate, Vec3, log, UIOpacity } from 'cc';\nimport { ResourcesLoader } from '../../../../framework/data/ResourcesLoader';\nimport { yy } from '../../../define/YYNamespace';\nimport { FightConstant } from '../../fight/FightConstant';\nimport { SpineComponentBase } from './SpineComponentBase';\n\nconst { ccclass } = _decorator;\n@ccclass\nexport class SpineNodeBase extends Node {\n\n    // 阵型孔位\n    private _formationIndex:number;\n\n    // 阵营\n    private _camp:number;\n    \n    public set formationIndex(v : number) {\n        this._formationIndex = v;\n    }\n    \n    public get formationIndex() : number {\n        return this._formationIndex\n    }\n    \n    \n    public get camp() : number {\n        return this._camp\n    }\n\n    \n    public set camp(v : number) {\n        this._camp = v;\n    }\n    \n    \n\n    private _spineCom:SpineComponentBase = null; \n\n    public get spineCom() :SpineComponentBase {\n        return this._spineCom\n    }\n    \n    constructor(spineNode:Node){\n        super();\n        this.addChild(spineNode);\n        this._spineCom = this.getComponentInChildren(SpineComponentBase);\n        this.addComponent(UIOpacity);\n    }\n\n    /**\n     * @description 立即播放当前动画\n     * @param actionName spine 动作名称\n     * @param isLoop 是否循环播放 默认值false\n    */\n    public play(actionName:string,isLoop?:boolean){\n        this._spineCom.play(actionName,isLoop);\n    }\n    /**\n     * @description 添加特效在角色身上\n     */\n    public addEffectFront(node:Node,offset?:Vec3) {\n        this._spineCom.addEffectFront(node,offset);\n    }\n\n    /**\n     * @description 添加特效在角色脚上\n     */\n    public addEffectBack(node:Node,offset?:Vec3){\n        this._spineCom.addEffectBack(node,offset);\n    }\n\n\n    /**\n     * addBloodUI\n     */\n    public addBloodUI(path?:string) {\n        path??=\"fight/prefabs/ui/hero_blood_ui\";\n        ResourcesLoader.load(path,(prefab:Prefab)=>{\n            let node = instantiate(prefab);\n            this._spineCom.addBloodUI(node);\n            if (this._camp == FightConstant.FightUnitType.Defend) {\n                node.setScale(new Vec3(-1,1,1));\n            }\n        });\n    }\n\n    /**\n     * updateBlood\n     */\n    public updateBlood(cur:number,top:number) {\n        this._spineCom.updateBlood(cur,top);\n    }\n\n    /**\n     * @description 换皮肤\n     * @param skinName:number 皮肤id\n     */\n    public changeSkin(skinName:string) {\n        this._spineCom.changeSkin(skinName);\n    }\n\n    /**\n     * \n     * @description 更换皮肤的单间装备\n     * @param skinName 新皮肤名字（装备所在的皮肤）\n     * @param oldSlotName 旧插槽的名字\n     * @param newSlotName 新插槽的名字\n     */\n    public changeEquip(skinName:string,oldSlotName:string,newSlotName:string){\n        this._spineCom.changeEquip(skinName,oldSlotName,newSlotName);\n    }\n\n    /** 动画开始回调 */\n    public setAnimateStartCallback(callback:yy.interfaces.SpineTrackEntryCallFunc) {\n        this._spineCom.setAnimateStartCallback(callback);\n    }\n\n    /** 动画结束回调 */\n    public setAnimateEndCallback(callback: yy.interfaces.SpineTrackEntryCallFunc) {\n        this._spineCom.setAnimateEndCallback(callback);\n    }\n\n    /** 动画被打断回调 */\n    public setAnimateInterruptCallback(callback: yy.interfaces.SpineTrackEntryCallFunc) {\n        this._spineCom.setAnimateInterruptCallback(callback);\n    }\n\n    /** 动画事件回调 */\n    public setAnimateEventCallback(callback) {\n        this._spineCom.setAnimateEventCallback(callback);\n    }\n}\n\n// 武将\nexport class HeroSpineNode extends SpineNodeBase {\n}\n// 敌方\nexport class MonsterSpineNode extends SpineNodeBase {\n}"]}