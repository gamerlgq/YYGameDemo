{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/YYGameDemo/client/trunk/project/assets/scripts/app/views/loading/Creator.ts"],"names":["LoadingCreator","instantiate","sceneMgr","ResourcesLoader","ViewCreatorBase","ViewProtocol","viewRegisterMgr","onInit","regMsg","ResLoadingLayer","onCreateResLoadingLayer","bind","TransLoadingLayer","onCreateTransLoadingLayer","event","viewInfo","getViewInfo","loadWithViewInfo","data","node","pushNewTableLayer","replaceTableContent","View","datas","getRawData","addTransitionLayer","com","getComponent","setEnterCalback","setCompleteCallback","setResLoadingList"],"mappings":";;;sHASaA,c;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AATJC,MAAAA,W,OAAAA,W;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,e,iBAAAA,e;;AAEAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,e,iBAAAA,e;;;;;;;gCAGIN,c,GAAN,MAAMA,cAAN;AAAA;AAAA,8CAA6C;AAEhDO,QAAAA,MAAM,GAAG;AACL,eAAKC,MAAL,CAAY;AAAA;AAAA,4CAAaC,eAAzB,EAA0C,KAAKC,uBAAL,CAA6BC,IAA7B,CAAkC,IAAlC,CAA1C;AACA,eAAKH,MAAL,CAAY;AAAA;AAAA,4CAAaI,iBAAzB,EAA2C,KAAKC,yBAAL,CAA+BF,IAA/B,CAAoC,IAApC,CAA3C;AACH;;AAEDD,QAAAA,uBAAuB,CAACI,KAAD,EAAgB;AACnC,cAAIC,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,WAAhB,CAA4B,SAA5B,EAAsC,iBAAtC,CAAf;AACA;AAAA;AAAA,kDAAgBC,gBAAhB,CAAiCF,QAAjC,EAA2CG,IAAD,IAAe;AACrD,gBAAIC,IAAI,GAAGlB,WAAW,CAACiB,IAAD,CAAtB;AACA;AAAA;AAAA,sCAASE,iBAAT;AACA;AAAA;AAAA,sCAASC,mBAAT,CAA6BF,IAA7B,EAAkCJ,QAAQ,CAACO,IAA3C;AACH,WAJD;AAKH;;AAEDT,QAAAA,yBAAyB,CAACC,KAAD,EAAe;AACpC,cAAIC,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,WAAhB,CAA4B,SAA5B,EAAsC,mBAAtC,CAAf;AACA;AAAA;AAAA,kDAAgBC,gBAAhB,CAAiCF,QAAjC,EAA2CG,IAAD,IAAe;AACrD,gBAAIK,KAAK,GAAGT,KAAK,CAACU,UAAN,EAAZ;AACA,gBAAIL,IAAI,GAAGlB,WAAW,CAACiB,IAAD,CAAtB;AACA;AAAA;AAAA,sCAASO,kBAAT,CAA4BN,IAA5B;AACA,gBAAIO,GAAG,GAAGP,IAAI,CAACQ,YAAL,CAAkB,mBAAlB,CAAV;AACAD,YAAAA,GAAG,CAACE,eAAJ,CAAoBL,KAAK,CAAC,CAAD,CAAzB;AACAG,YAAAA,GAAG,CAACG,mBAAJ,CAAwBN,KAAK,CAAC,CAAD,CAA7B;AACAG,YAAAA,GAAG,CAACI,iBAAJ,CAAsBP,KAAK,CAAC,CAAD,CAA3B;AACH,WARD;AASH;;AA3B+C,O","sourcesContent":["import { instantiate, log, Prefab } from \"cc\";\nimport { sceneMgr } from \"../../../framework/core/SceneMgr\";\nimport { ResourcesLoader } from \"../../../framework/data/ResourcesLoader\";\nimport { Message } from \"../../../framework/listener/Message\";\nimport { ViewCreatorBase } from \"../../../framework/ui/ViewCreatorBase\";\nimport { ViewProtocol } from \"../../define/ViewProtocol\";\nimport { viewRegisterMgr } from \"../../define/ViewRegisterMgr\";\nimport { TransLoadingLayer } from \"./TransLoadingLayer\";\n\nexport class LoadingCreator extends ViewCreatorBase {\n\n    onInit() {\n        this.regMsg(ViewProtocol.ResLoadingLayer, this.onCreateResLoadingLayer.bind(this))\n        this.regMsg(ViewProtocol.TransLoadingLayer,this.onCreateTransLoadingLayer.bind(this))\n    }\n\n    onCreateResLoadingLayer(event:Message) {\n        let viewInfo = viewRegisterMgr.getViewInfo(\"loading\",\"ResLoadingLayer\");\n        ResourcesLoader.loadWithViewInfo(viewInfo,(data:Prefab)=>{\n            let node = instantiate(data);\n            sceneMgr.pushNewTableLayer();\n            sceneMgr.replaceTableContent(node,viewInfo.View);\n        })\n    }\n\n    onCreateTransLoadingLayer(event:Message){\n        let viewInfo = viewRegisterMgr.getViewInfo(\"loading\",\"TransLoadingLayer\");\n        ResourcesLoader.loadWithViewInfo(viewInfo,(data:Prefab)=>{\n            let datas = event.getRawData();\n            let node = instantiate(data);\n            sceneMgr.addTransitionLayer(node);\n            let com = node.getComponent(\"TransLoadingLayer\") as TransLoadingLayer;\n            com.setEnterCalback(datas[0]);\n            com.setCompleteCallback(datas[1]);\n            com.setResLoadingList(datas[2]);\n        })\n    }\n}"]}