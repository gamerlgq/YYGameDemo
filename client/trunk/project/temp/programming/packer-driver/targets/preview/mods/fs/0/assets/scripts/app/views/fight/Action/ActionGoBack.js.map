{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/GameDemoReal/assets/scripts/app/views/fight/action/ActionGoBack.ts"],"names":["ActionGoBack","tween","Vec3","FightConstant","ActionBase","fightActionMgr","goBack","data","own","pos","getUnitPos","camp","formationIndex","config","animCfg","params","duration","_scale","_getScale","parallel","to","position","progress","start","end","current","ratio","scale","call","setSiblingIndex","FightUnitType","Attack","Defend"],"mappings":";;;sFAMaA,Y;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AANcC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;;AAEzBC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,U,iBAAAA,U;;AACiBC,MAAAA,c,iBAAAA,c;;;;;;;8BAEbL,Y,GAAN,MAAMA,YAAN;AAAA;AAAA,oCAAsC;AAEzC;AACJ;AACA;AACA;AACA;AACA;AACWM,QAAAA,MAAM,CAACC,IAAD,EAAmC;AAC5C,cAAIC,GAAG,GAAGD,IAAI,CAACC,GAAf;AACA,cAAIC,GAAQ,GAAG;AAAA;AAAA,gDAAeC,UAAf,CAA0B,CAACF,GAAG,CAACG,IAAL,EAAUH,GAAG,CAACI,cAAd,CAA1B,CAAf;AACA,cAAIC,MAAM,GAAGN,IAAI,CAACO,OAAlB;AACA,cAAIC,MAAM,GAAGF,MAAM,CAACE,MAApB;AACA,cAAIC,QAAe,GAAGD,MAAM,CAAC,CAAD,CAA5B;;AACA,cAAIE,MAAM,GAAG,KAAKC,SAAL,CAAeV,GAAf,CAAb;;AACA,iBAAOP,KAAK,GAAGkB,QAAR,CACHlB,KAAK,GAAGmB,EAAR,CAAWJ,QAAX,EAAoB;AAChBK,YAAAA,QAAQ,EAACZ;AADO,WAApB,EAEE;AACEa,YAAAA,QAAQ,EAAC,CAACC,KAAD,EAAOC,GAAP,EAAWC,OAAX,EAAmBC,KAAnB,KAA2B;AAChC,qBAAOH,KAAK,GAAG,CAACC,GAAG,GAAGD,KAAP,IAAgBG,KAA/B;AACH;AAHH,WAFF,CADG,EAQHzB,KAAK,GAAGmB,EAAR,CAAWJ,QAAX,EAAoB;AAChBW,YAAAA,KAAK,EAACV;AADU,WAApB,CARG,EAWHhB,KAAK,GAAG2B,IAAR,CAAa,MAAI;AACbpB,YAAAA,GAAG,CAACqB,eAAJ,CAAoBrB,GAAG,CAACI,cAAxB;AACH,WAFD,CAXG,CAAP;AAeH;;AAGOM,QAAAA,SAAS,CAACV,GAAD,EAA0C;AACvD,cAAIA,GAAG,CAACG,IAAJ,IAAY;AAAA;AAAA,8CAAcmB,aAAd,CAA4BC,MAA5C,EAAmD;AAC/C,mBAAO,IAAI7B,IAAJ,CAAS,CAAT,EAAW,CAAX,EAAa,CAAb,CAAP;AACH,WAFD,MAEM,IAAIM,GAAG,CAACG,IAAJ,IAAY;AAAA;AAAA,8CAAcmB,aAAd,CAA4BE,MAA5C,EAAmD;AACrD,mBAAO,IAAI9B,IAAJ,CAAS,CAAC,CAAV,EAAY,CAAZ,EAAc,CAAd,CAAP;AACH;AACJ;;AAvCwC,O","sourcesContent":["import { log, Node, Tween, tween, Vec3 } from \"cc\";\nimport { HeroSpineNode, MonsterSpineNode } from \"../../common/spine/SpineNodeBase\";\nimport { FightConstant } from \"../FightConstant\";\nimport { ActionBase } from \"./ActionBase\";\nimport { FightActionData, fightActionMgr } from \"./FightActionMgr\";\n\nexport class ActionGoBack extends ActionBase {\n    \n    /**\n     * \n     * @param own 移动节点\n     * @param pos 阵型孔位置\n     * @param duration 持续时间\n     */\n    public goBack(data:FightActionData):Tween<Node> {\n        let own = data.own;\n        let pos:Vec3 = fightActionMgr.getUnitPos([own.camp,own.formationIndex]);\n        let config = data.animCfg;\n        let params = config.params;\n        let duration:number = params[0]\n        let _scale = this._getScale(own);\n        return tween().parallel(\n            tween().to(duration,{\n                position:pos\n            },{\n                progress:(start,end,current,ratio)=>{\n                    return start + (end - start) * ratio;\n                }\n            }),\n            tween().to(duration,{\n                scale:_scale\n            }),\n            tween().call(()=>{\n                own.setSiblingIndex(own.formationIndex);\n            })\n        )    \n    }\n\n\n    private _getScale(own:HeroSpineNode|MonsterSpineNode):Vec3 {\n        if (own.camp == FightConstant.FightUnitType.Attack){\n            return new Vec3(1,1,1)\n        }else if (own.camp == FightConstant.FightUnitType.Defend){\n            return new Vec3(-1,1,1)\n        }\n    }\n}"]}