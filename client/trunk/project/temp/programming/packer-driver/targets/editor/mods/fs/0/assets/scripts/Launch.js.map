{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/YYGameDemo/client/trunk/project/assets/scripts/Launch.ts"],"names":["_decorator","Component","JsonAsset","log","sys","director","GameConfig","ccclass","property","Launch","type","onLoad","serverConfig","config","json","JSON","stringify","Object","keys","forEach","key","value","start","_keepScreenOn","scheduleOnce","dt","_startHotUpdate","isNative","os","OS","IOS","ANDROID","jsb","device","setKeepScreenOn","loadScene"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAQSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,G,OAAAA,G;AAAKC,MAAAA,G,OAAAA,G;AAAKC,MAAAA,Q,OAAAA,Q;;AAE5CC,MAAAA,U,iBAAAA,U;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;wBAGjBS,M,WADZF,OAAO,CAAC,QAAD,C,UAGHC,QAAQ,CAAC;AAACE,QAAAA,IAAI,EAACR;AAAN,OAAD,C,oCAHb,MACaO,MADb,SAC4BR,SAD5B,CACsC;AAAA;AAAA;;AAAA;AAAA;;AAKlCU,QAAAA,MAAM,GAAE;AACJ,cAAI,KAAKC,YAAT,EAAuB;AACnB,gBAAIC,MAAM,GAAG,KAAKD,YAAL,CAAkBE,IAA/B;AACAX,YAAAA,GAAG,CAAC,mBAAD,EAAqBY,IAAI,CAACC,SAAL,CAAeH,MAAf,CAArB,CAAH;AACAI,YAAAA,MAAM,CAACC,IAAP,CAAYL,MAAZ,EAAoBM,OAApB,CAA6BC,GAAD,IAAO;AAC/B,kBAAIC,KAAK,GAAGR,MAAM,CAACO,GAAD,CAAlB;AACA;AAAA;AAAA,4CAAWA,GAAX,IAAkBC,KAAlB;AACH,aAHD;AAIH;AACJ;;AAEDC,QAAAA,KAAK,GAAE;AACH;AACA;AACA,eAAKC,aAAL;;AACA,eAAKC,YAAL,CAAmBC,EAAD,IAAa;AAC3B,iBAAKC,eAAL;AACH,WAFD,EAEE,CAFF;AAGH,SAvBiC,CAyBlC;;;AACQH,QAAAA,aAAa,GAAE;AACnB,cAAInB,GAAG,CAACuB,QAAR,EAAkB;AACd,gBAAIvB,GAAG,CAACwB,EAAJ,IAAUxB,GAAG,CAACyB,EAAJ,CAAOC,GAAjB,IAAwB1B,GAAG,CAACwB,EAAJ,IAAUxB,GAAG,CAACyB,EAAJ,CAAOE,OAA7C,EAAsD;AAClDC,cAAAA,GAAG,CAACC,MAAJ,CAAWC,eAAX,CAA2B,IAA3B;AACH;AACJ;AACJ,SAhCiC,CAkClC;;;AACQR,QAAAA,eAAe,GAAG;AACtBrB,UAAAA,QAAQ,CAAC8B,SAAT,CAAmB,WAAnB,EAAgC,MAAM,CAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH,WAVD;AAWH;;AA/CiC,O;;;;;iBAGX,I","sourcesContent":["/*\n * @Author: liuguoqing\n * @Date: 2022-03-03 13:52:55\n * @LastEditors: liuguoqing\n * @LastEditTime: 2022-03-03 17:52:07\n * @Description: file content\n */\n\nimport { _decorator, Component, JsonAsset, log, sys, director, dynamicAtlasManager } from 'cc';\nimport { ResourcesLoader } from './framework/data/ResourcesLoader';\nimport { GameConfig } from './GameConfig';\nconst { ccclass, property } = _decorator;\n \n@ccclass('Launch')\nexport class Launch extends Component {\n\n    @property({type:JsonAsset})\n    serverConfig:JsonAsset=null;\n\n    onLoad(){\n        if (this.serverConfig) {\n            let config = this.serverConfig.json;\n            log(\"ServerConfig.json\",JSON.stringify(config));\n            Object.keys(config).forEach((key)=>{\n                let value = config[key];\n                GameConfig[key] = value;\n            })\n        }\n    }\n\n    start(){\n        //动态合图\n        // dynamicAtlasManager.enabled = false;\n        this._keepScreenOn();\n        this.scheduleOnce((dt:number)=>{\n            this._startHotUpdate();\n        },1)\n    }\n\n    //设置屏幕常亮\n    private _keepScreenOn(){\n        if (sys.isNative) {\n            if (sys.os == sys.OS.IOS || sys.os == sys.OS.ANDROID) {\n                jsb.device.setKeepScreenOn(true);\n            }\n        }\n    }\n\n    // 走热更新流程\n    private _startHotUpdate() {\n        director.loadScene(\"hotUpdate\", () => {\n            // 预加载\n            // let paths = [\n            //     \"prefab/tongyong_ui/tongyong_tipsUI_00\",\n            //     \"prefab/tongyong_ui/tongyong_tipsUI_01\",\n            // ];\n            // for (let index = 0; index < paths.length; index++) {\n            //     const element = paths[index];\n            //     ResourcesLoader.preload(element, () => {});\n            // }\n        });\n    }\n}\n\n"]}