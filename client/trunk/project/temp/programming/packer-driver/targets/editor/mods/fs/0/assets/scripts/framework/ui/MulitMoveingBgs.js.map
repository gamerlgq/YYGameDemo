{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/GameDemoReal/assets/scripts/framework/ui/MulitMoveingBgs.ts"],"names":["_decorator","Component","Node","v3","CCFloat","posAdd","v3ToV2","DInertiaMove","ccclass","property","BgTarget","MulitMoveingBgs","type","start","mainBg","addComponent","onPosChange","onMainBgChangePos","bind","insreasedPos","subBg","forEach","element","subMovePos","clone","multiplyScalar","moveScale","bgNode","move","byPos","isDInertia","dInertiaMoveComp","getComponent","minX","maxX","newPos","position","add","x","y","subtract","dis","length","stop"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, CCInteger, Prefab, v3, tween, Vec3, Vec2, log, CCFloat } from 'cc';\nimport { posAdd, v2ToV3, v3ToV2 } from '../utils/functions';\nimport { DInertiaMove } from './DInertiaMove';\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = MulitMoveingBgs\n * DateTime = Mon Mar 14 2022 17:34:40 GMT+0800 (中国标准时间)\n * Author = maikx123456\n * FileBasename = MulitMoveingBgs.ts\n * FileBasenameNoExtension = MulitMoveingBgs\n * URL = db://assets/scripts/app/views/common/MulitMoveingBgs.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/zh/\n *\n */\n\n@ccclass('BgTarget')\nclass BgTarget{\n    @property(Node)\n    bgNode: Node;\n    @property(CCFloat)\n    moveScale: number;\n}\n\n@ccclass('MulitMoveingBgs')\nexport class MulitMoveingBgs extends Component {\n    @property({ type: [BgTarget] })\n    private subBg: BgTarget[] = [];\n\n    @property(Node)\n    private mainBg: Node;\n    @property(CCFloat)\n    private minX: number = 0;\n    @property(CCFloat)\n    private maxX: number = 0;\n\n    start() {\n        this.mainBg.addComponent(DInertiaMove).onPosChange = this.onMainBgChangePos.bind(this)\n    }\n\n    private onMainBgChangePos(insreasedPos:Vec3) {\n        this.subBg.forEach(element => {\n            let subMovePos = insreasedPos.clone().multiplyScalar(element.moveScale)\n            posAdd(element.bgNode, v3ToV2(subMovePos))\n        });\n    }\n\n\n    move(byPos: Vec2, isDInertia: boolean) {\n        // 惯性移动\n        if (isDInertia) {\n            let dInertiaMoveComp = this.mainBg.getComponent(DInertiaMove)\n            dInertiaMoveComp.move(byPos, this.minX, this.maxX)\n        }\n        else {\n            // 非惯性移动\n             //判断结束\n             let newPos = this.mainBg.position.clone().add(v3(byPos.x, byPos.y))\n             if (this.minX && newPos.x < this.minX) {\n                newPos.x = this.minX\n            }\n            if (this.maxX && newPos.x > this.maxX) {\n                newPos.x = this.maxX\n            }\n\n            let insreasedPos = newPos.subtract(this.mainBg.position)\n            let dis =  insreasedPos.length()\n            if (dis !=0 ) {\n                posAdd(this.mainBg, byPos, this.minX, this.maxX)\n                this.onMainBgChangePos(insreasedPos)\n            }\n\n        }\n    }\n\n    stop() {\n        this.mainBg.addComponent(DInertiaMove).stop()\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/zh/scripting/decorator.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}