{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/YYGameDemo/client/trunk/project/assets/scripts/app/views/common/TouchMain.ts"],"names":["_decorator","Component","Node","instantiate","UITransform","ResourcesLoader","v2ToV3","viewRegisterMgr","TouchEffect","ccclass","property","disallowMultiple","TouchMain","onLoad","start","viewInfo","getViewInfo","loadWithViewInfo","pre","_touchEffectNode","node","addChild","active","_touchEffectComp","getChildByName","getComponent","on","EventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","onTouchCancel","event","preventSwallow","pos","getUILocation","nodePos","convertToNodeSpaceAR","position","play"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, EventTouch, Prefab, instantiate, v3, UITransform, log, Input, input, EventMouse } from 'cc';\nimport { ResourcesLoader } from '../../../framework/data/ResourcesLoader';\nimport { v2ToV3 } from '../../../framework/utils/functions';\nimport { viewRegisterMgr } from '../../define/ViewRegisterMgr';\nimport { TouchEffect } from './TouchEffect';\nconst { ccclass, property,disallowMultiple } = _decorator;\n\n/**\n * Predefined variables\n * Name = TouchMain\n * DateTime = Tue Mar 22 2022 19:57:53 GMT+0800 (中国标准时间)\n * Author = maikx123456\n * FileBasename = TouchMain.ts\n * FileBasenameNoExtension = TouchMain\n * URL = db://assets/scripts/app/views/common/TouchMain.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/zh/\n *\n */\n\n@ccclass('TouchMain')\n@disallowMultiple(true)\nexport class TouchMain extends Component {\n    private _touchEffectNode:Node\n    private _touchEffectComp:TouchEffect\n\n    onLoad() {\n        \n    }\n    start() {\n        let viewInfo = viewRegisterMgr.getViewInfo(\"commonUI\",\"TouchEffect\")\n        ResourcesLoader.loadWithViewInfo(viewInfo, (pre:Prefab)=>{\n            this._touchEffectNode = instantiate(pre)\n            this.node.addChild(this._touchEffectNode)\n            this._touchEffectNode.active = false\n            this._touchEffectComp = this._touchEffectNode.getChildByName(\"ScriptNode\").getComponent(TouchEffect)\n        },false)\n        \n        this.node.on(Node.EventType.TOUCH_START, this.onTouchStart,this)\n        this.node.on(Node.EventType.TOUCH_MOVE, this.onTouchMove,this)\n        this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd,this)\n        this.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchCancel,this)\n        // this.node.eventProcessor\n        \n        // input.on(Input.EventType.MOUSE_UP, this.onTouchEnd, this)\n    }\n\n    onTouchEnd(event: EventTouch) {\n        event.preventSwallow = true\n        \n    }\n\n    private onTouchStart(event: EventTouch) {\n        event.preventSwallow = true\n\n        if (!this._touchEffectNode) {\n            return\n        }\n\n        let pos = event.getUILocation()\n        let nodePos = this.node.getComponent(UITransform).convertToNodeSpaceAR(v2ToV3(pos))\n        this._touchEffectNode.position = nodePos\n        this._touchEffectComp.play()\n    }\n    private onTouchMove(event: EventTouch) {\n        event.preventSwallow = true\n    }\n    private onTouchCancel(event: EventTouch) {\n        event.preventSwallow = true\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/zh/scripting/decorator.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}