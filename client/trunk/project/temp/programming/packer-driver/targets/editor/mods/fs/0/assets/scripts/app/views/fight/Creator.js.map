{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/GameDemoReal/assets/scripts/app/views/fight/Creator.ts"],"names":["FightCreator","instantiate","sceneMgr","ResourcesLoader","ViewCreatorBase","ViewProtocol","viewRegisterMgr","FightMainLayer","onInit","regMsg","_onCreateFightMainLayer","bind","FightFormation","onCreateFormationView","event","viewInfo","getViewInfo","loadWithViewInfo","data","bgNode","pushNewTableLayer","replaceTableContent","View","com","getComponentInChildren","load","json","init","node"],"mappings":";;;sIAiBaA,Y;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAVJC,MAAAA,W,OAAAA,W;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,e,iBAAAA,e;;AAEAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,c,iBAAAA,c;;;;;;;8BAGIP,Y,GAAN,MAAMA,YAAN;AAAA;AAAA,8CAA2C;AAE9CQ,QAAAA,MAAM,GAAG;AACL,eAAKC,MAAL,CAAY;AAAA;AAAA,4CAAaF,cAAzB,EAAyC,KAAKG,uBAAL,CAA6BC,IAA7B,CAAkC,IAAlC,CAAzC;AACA,eAAKF,MAAL,CAAY;AAAA;AAAA,4CAAaG,cAAzB,EAAyC,KAAKC,qBAAL,CAA2BF,IAA3B,CAAgC,IAAhC,CAAzC;AACH;;AAEOD,QAAAA,uBAAuB,CAACI,KAAD,EAAgB;AAC3C,cAAIC,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,WAAhB,CAA4B,OAA5B,EAAoC,gBAApC,CAAf;AACA;AAAA;AAAA,kDAAgBC,gBAAhB,CAAiCF,QAAjC,EAA2CG,IAAD,IAAe;AACrD,gBAAIC,MAAM,GAAGlB,WAAW,CAACiB,IAAD,CAAxB;AACA;AAAA;AAAA,sCAASE,iBAAT;AACA;AAAA;AAAA,sCAASC,mBAAT,CAA6BF,MAA7B,EAAoCJ,QAAQ,CAACO,IAA7C;AACA,gBAAIC,GAAG,GAAGJ,MAAM,CAACK,sBAAP;AAAA;AAAA,iDAAV;AACA;AAAA;AAAA,oDAAgBC,IAAhB,CAAqB,oBAArB,EAA2CC,IAAD,IAAkB;AACxDH,cAAAA,GAAG,CAACI,IAAJ,CAASD,IAAT;AACH,aAFD;AAGH,WARD;AASH;;AAEOb,QAAAA,qBAAqB,CAACC,KAAD,EAAgB;AACzC,cAAIC,QAAQ,GAAG;AAAA;AAAA,kDAAgBC,WAAhB,CAA4B,OAA5B,EAAoC,gBAApC,CAAf;AACA;AAAA;AAAA,kDAAgBC,gBAAhB,CAAiCF,QAAjC,EAA2CG,IAAD,IAAe;AACrD,gBAAIU,IAAI,GAAG3B,WAAW,CAACiB,IAAD,CAAtB;AACA;AAAA;AAAA,sCAASE,iBAAT;AACA;AAAA;AAAA,sCAASC,mBAAT,CAA6BO,IAA7B,EAAkCb,QAAQ,CAACO,IAA3C;AACH,WAJD;AAKH;;AA3B6C,O","sourcesContent":["/*\n * @Author: liuguoqing\n * @Date: 2022-03-19 11:17:19\n * @LastEditors: liuguoqing\n * @LastEditTime: 2022-03-20 23:18:12\n * @Description: file content\n */\nimport { instantiate, JsonAsset, log, Prefab } from \"cc\";\nimport { sceneMgr } from \"../../../framework/core/SceneMgr\";\nimport { ResourcesLoader } from \"../../../framework/data/ResourcesLoader\";\nimport { Message } from \"../../../framework/listener/Message\";\nimport { ViewCreatorBase } from \"../../../framework/ui/ViewCreatorBase\";\nimport { ViewProtocol } from \"../../define/define\";\nimport { viewRegisterMgr } from \"../../define/ViewRegisterMgr\";\nimport { FightMainLayer } from \"./FightMainLayer\";\n\n\nexport class FightCreator extends ViewCreatorBase {\n\n    onInit() {\n        this.regMsg(ViewProtocol.FightMainLayer, this._onCreateFightMainLayer.bind(this))\n        this.regMsg(ViewProtocol.FightFormation, this.onCreateFormationView.bind(this))\n    }\n\n    private _onCreateFightMainLayer(event:Message) {\n        let viewInfo = viewRegisterMgr.getViewInfo(\"fight\",\"FightMainLayer\");\n        ResourcesLoader.loadWithViewInfo(viewInfo,(data:Prefab)=>{\n            let bgNode = instantiate(data);\n            sceneMgr.pushNewTableLayer();\n            sceneMgr.replaceTableContent(bgNode,viewInfo.View);\n            let com = bgNode.getComponentInChildren(FightMainLayer);\n            ResourcesLoader.load(\"fight/datas/report\",(json:JsonAsset)=>{\n                com.init(json);\n            });\n        })\n    }\n\n    private onCreateFormationView(event:Message) {\n        let viewInfo = viewRegisterMgr.getViewInfo(\"fight\",\"FightFormation\");\n        ResourcesLoader.loadWithViewInfo(viewInfo,(data:Prefab)=>{\n            let node = instantiate(data);\n            sceneMgr.pushNewTableLayer();\n            sceneMgr.replaceTableContent(node,viewInfo.View);\n        })\n    }\n\n}"]}