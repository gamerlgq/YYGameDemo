{"version":3,"sources":["file:///Users/steven/Workspaces/CocosCreatorProjects/3D/YYGameDemo/client/trunk/project/assets/scripts/app/views/fight/event/FightEventMgr.ts"],"names":["FightEventMgr","log","Singleton","FightConstant","fightEventMgr","init","getInstance","_init","_eventHandlers","Map","addEventListener","eventId","handler","handlerQueue","get","Array","set","push","removeEventListener","idx","indexOf","splice","send","event","_getEventName","getEventId","getEventData","_dispatchEvent","FightEvent","Game_Star","Game_End","Game_Pause","Game_Resume","Game_Replay","Round_Start","Round_End","Action_Star","Action_End","Attack_Start","Attack_End","Result_Start","Result_End","Blood_Change","forEach","destory","destoryInstance","clear"],"mappings":"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","sourcesContent":["/*\n * @Author: liuguoqing\n * @Date: 2022-03-19 11:17:19\n * @LastEditors: liuguoqing\n * @LastEditTime: 2022-03-20 23:03:19\n * @Description: file content\n */\nimport { log } from \"cc\";\nimport { Singleton } from \"../../../../framework/components/Singleton\";\nimport { FightConstant } from \"../FightConstant\";\nimport { FightEvent } from \"./FightEvent\";\n\ninterface FightEventHandler{\n    (event:FightEvent):void\n}\n\nexport let fightEventMgr:FightEventMgr = null;\n\nexport class FightEventMgr extends Singleton{\n\n    private _eventHandlers:Map<number,Array<FightEventHandler>>=null;\n    \n    /**\n     * init\n     */\n    public static init() {\n        fightEventMgr = FightEventMgr.getInstance<FightEventMgr>();\n        fightEventMgr._init();\n    }\n\n    private _init(){\n        this._eventHandlers = new Map<number,Array<FightEventHandler>>();\n    }\n     \n    public addEventListener(eventId:number,handler:FightEventHandler){\n        let handlerQueue = this._eventHandlers.get(eventId);\n        if (!handlerQueue) {\n            handlerQueue = new Array<FightEventHandler>();\n            this._eventHandlers.set(eventId,handlerQueue);\n        }\n        handlerQueue.push(handler);\n    }\n\n    public removeEventListener(eventId:number,handler:FightEventHandler){\n        let handlerQueue = this._eventHandlers.get(eventId);\n        if (handlerQueue) {\n            let idx = handlerQueue.indexOf(handler);\n            if (idx != -1){\n                handlerQueue.splice(idx);\n            }\n        }\n    }\n\n    public send(event:FightEvent){\n        log(\"[Debug][FightEvent:]\",this._getEventName(event.getEventId()),\"=====>\",event.getEventData());\n        this._dispatchEvent(event);\n    }\n\n    private _getEventName(eventId) {\n        switch (eventId) {\n            case FightConstant.FightEvent.Game_Star:\n                return \"Game_Star\";\n            case FightConstant.FightEvent.Game_End:\n                return \"Game_End\";\n            case FightConstant.FightEvent.Game_Pause:\n                return \"Game_Pause\";\n            case FightConstant.FightEvent.Game_Resume:\n                return \"Game_Resume\";\n            case FightConstant.FightEvent.Game_Replay:\n                return \"Game_Replay\";\n            case FightConstant.FightEvent.Round_Start:\n                return \"Round_Start\";\n            case FightConstant.FightEvent.Round_End:\n                return \"Round_End\";\n            case FightConstant.FightEvent.Action_Star:\n                return \"Action_Star\";\n            case FightConstant.FightEvent.Action_End:\n                return \"Action_End\";\n            case FightConstant.FightEvent.Attack_Start:\n                return \"Attack_Start\";\n            case FightConstant.FightEvent.Attack_End:\n                    return \"Attack_End\";\n            case FightConstant.FightEvent.Result_Start:\n                return \"Result_Start\";\n            case FightConstant.FightEvent.Result_End:\n                return \"Result_End\";\n            case FightConstant.FightEvent.Blood_Change:\n                return \"Blood_Change\";\n        }\n    }\n\n    private _dispatchEvent(event:FightEvent){\n        let eventId = event.getEventId();\n        let handlerQueue = this._eventHandlers.get(eventId);\n        if (handlerQueue) {\n            handlerQueue.forEach((handler)=>{\n                if (handler) {\n                    handler(event);\n                }\n            })\n        }\n    }\n\n    public destory(){\n        FightEventMgr.destoryInstance();\n    }\n\n    public clear(){\n        fightEventMgr = null;\n    }\n}"]}